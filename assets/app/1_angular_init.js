var iCaseiApp=angular.module("iCaseiApp",["ngAnimate","ngResource","iCaseiControllers","ngCookies"]);iCaseiApp.config(["$controllerProvider","$compileProvider",function($controllerProvider,$compileProvider){iCaseiApp.controllerProvider=$controllerProvider.register,iCaseiApp.lazyController=function(name,controller){window[name+"_controller"]||(window[name+"_controller"]=!0,$controllerProvider.register(name,controller))},iCaseiApp.lazyDirective=function(name,controller){window[name+"_directive"]||(window[name+"_directive"]=!0,$compileProvider.directive(name,controller))}}]),iCaseiApp.config(["$httpProvider",function($httpProvider){$httpProvider.defaults.headers.common["X-CSRF-Token"]=$("meta[name=csrf-token]").attr("content"),$httpProvider.defaults.withCredentials=!1,$httpProvider.defaults.useXDomain=!0,$httpProvider.defaults.headers.common["Access-Control-Allow-Headers"]="*",$httpProvider.defaults.headers.common["Access-Control-Allow-Methods"]="*",$httpProvider.defaults.headers.common["Access-Control-Allow-Origin"]="*",delete $httpProvider.defaults.headers.common["X-Requested-With"]}]),iCaseiApp.directive("script",function(){return{restrict:"E",scope:!1,link:function(scope,elem,attr){if("text/javascript-lazy"===attr.type){var code=elem.text();new Function(code)()}}}}),iCaseiApp.directive("ngIcaseiInclude",["$compile","$http",function($compile,$http){return{restrict:"A",scope:!0,link:function(scope,element,attr){var id=attr.ngIcaseiInclude;id=(id=id.replace(/\//gi,"_")).replace(/\'/gi,"");var template=document.getElementById(id);null===template?$http({method:"GET",url:attr.ngIcaseiInclude.replace(/\'/gi,"")}).then(function(response){element.append(jQuery(response.data)),$compile(element.contents())(scope)},function(response){alert("Erro ->"+response.data)}):(element.append(template.content.cloneNode(!0)),$compile(element.contents())(scope))}}}]);var iCaseiControllers=angular.module("iCaseiControllers",[]);window.iCaseiApp=iCaseiApp,window.iCaseiControllers=iCaseiControllers;var AngularHelper=function(){var AngularHelper=function(){};return AngularHelper.compile=function($targetDom,htmlToCompile){angular.element($targetDom).injector().invoke(["$window","$location","$compile","$rootScope",function($window,$location,$compile,$rootScope){var $scope=$targetDom.append(htmlToCompile).scope();$compile($targetDom)($scope||$rootScope),$scope.$apply()}])},AngularHelper}();!function(){function forecastService($resource){return $resource("https://services.icasei.com.br/api/publico/v1/forecast",{latLng:"@latLng",lang:"pt",units:"ca"},{listar:{method:"GET"}},{})}iCaseiApp.service("forecastService",forecastService),forecastService.$inject=["$resource"]}(),function(){function forecastController(){}iCaseiApp.controller("forecastController",forecastController),forecastController.$inject=["$scope","forecastService"]}(),function(){"use strict";function forecastWidget(forecastService){function controller($scope){forecastService.listar({latLng:$scope.latLng},{},function(data){$scope.title=I18n.t("forecast.title"),$scope.signature=I18n.t("forecast.signature");var forecasts=data.data.daily.data.slice(0,5);$scope.forecasts=forecasts.map(function(forecast){return{date:formatDate(forecast.time),temperatureMin:Math.round(forecast.temperatureMin),temperatureMax:Math.round(forecast.temperatureMax),chanceOfPrecipitation:100*forecast.precipProbability,windSpeed:Math.round(forecast.windSpeed),weatherIconClass:getWeatherIconClass(forecast.icon)}}),$scope.forecasts[0].temperatureCurrent=Math.round(data.data.currently.temperature),$scope.forecasts[0].weatherIconClass=getWeatherIconClass(data.data.currently.icon)},function(data){console.log(data)}),$scope.hasWeatherConditions=function(){return $scope.temperature&&$scope.weatherIconClass},$scope.hasForecasts=function(){return $scope.forecasts&&$scope.forecasts.length>0},$scope.hasCurrentWeatherConditions=function(){return angular.isDefined($scope.forecasts[0].temperatureCurrent)}}var directive={controller:controller,restrict:"E",scope:{latLng:"@latLng"},templateUrl:"/components/forecast/component.html"},getWeatherIconClass=function(weatherIconCode){return weatherIconCode&&weatherIconClasses.hasOwnProperty(weatherIconCode)?weatherIconClasses[weatherIconCode]:defaultWeatherIcon},weatherIconClasses={"clear-day":"wi-day-sunny hot","clear-night":"wi-day-sunny hot",rain:"wi-rain cold",snow:"wi-snow cold",sleet:"wi-sleet cold",wind:"wi-strong-wind cold",fog:"wi-fog",cloudy:"wi-cloudy","partly-cloudy-day":"wi-day-cloudy hot","partly-cloudy-night":"wi-day-cloudy hot"},defaultWeatherIcon="wi-na",formatDate=function(inuxEpoch){var date=new Date(1e3*inuxEpoch),weekDays=[I18n.t("forecast.days.domingo"),I18n.t("forecast.days.segunda"),I18n.t("forecast.days.terca"),I18n.t("forecast.days.quarta"),I18n.t("forecast.days.quinta"),I18n.t("forecast.days.sexta"),I18n.t("forecast.days.sabado")],dirtyDay=date.getDate();return(dirtyDay<10?"0"+dirtyDay:dirtyDay)+"/"+(date.getMonth()+1)+" ("+weekDays[date.getDay()]+")"};return controller.$inject=["$scope","$element","$attrs"],directive}iCaseiApp.directive("forecastWidget",forecastWidget),forecastWidget.$inject=["forecastService"]}(),function(){function enqueteController(){}iCaseiApp.controller("enqueteController",enqueteController)}(),function(){"use strict";function enqueteWidget(){function controller($scope,$window,$element,$attrs,$sce){var template_enquete=new TemplateEnquete({id_enquete:$scope.data}),login=get_meta("noivos");$scope.usuario={resposta:null,error:!1,error_message:"",resposta_enviada:!1},$scope.selection="voto",$scope.CD=get_meta("CD"),$scope.titulo="",$scope.subTitulo="",$scope.respostas=null,$scope.responseTooLarge=!1,$scope.status=0,$scope.btn_votar_label=I18n.t("formhelper.buttons.send"),$scope.btn_ver_resultado_label=I18n.t("formhelper.buttons.see_results"),$scope.btn_voltar_votar_label=I18n.t("formhelper.buttons.return_vote");var updateScope=function(){$scope.$apply(function(){$scope.titulo=template_enquete.get("enquete"),$scope.subTitulo=template_enquete.get("subtitulo"),$scope.status=template_enquete.get("status"),$scope.enqueteTotal=template_enquete.get("total"),$scope.respostas=template_enquete.get("respostas"),$scope.respostas&&$scope.respostas.map(function(row){(row.resposta.length>80||$window.outerWidth<=768)&&($scope.responseTooLarge=!0)})})};$scope.decodeContent=function(value){return value?$sce.trustAsHtml(value):""},$scope.getSecondButtonText=function(selection){return"respostas"==selection?I18n.t("poll.buttons.back"):I18n.t("poll.buttons.see_answer")},$scope.translateTotalResposta=function(total_resposta){return I18n_translate("poll.votes",{votes:total_resposta})},$scope.formatTotalEnquete=function(valor){return number_format(valor,"n")},load_js("//assets1.icasei.com.br/assets/components_plugins/jquery.easypiechart.min.js",function(){var displayErrorMessage=function(model){1==$scope.versao?$(".enquete-"+$scope.data+" .def-result-message").addClass("error").removeClass("success").html(model.get("message")).show():$(".enquete-"+$scope.data+" div .step1 ul").addClass("enviado")},displayResult=function(){$scope.$apply(function(){$scope.selection="respostas"}),1==$scope.versao?$(".enquete-"+$scope.data+" .def-result-message").html("").hide():($(".enquete-"+$scope.data+" div .step1").removeClass("fadeIn"),$(".enquete-"+$scope.data+" div .step2").addClass("fadeIn"),$(".enquete-"+$scope.data+" .chart").easyPieChart({easing:"easeOut",barColor:"#0f0f0f",trackColor:"#e7e7e7",scaleColor:"transparent",lineCap:"butt",lineWidth:8,size:118,onStep:function(from,to,percent){$(this.el).find(".percent").text(Math.round(percent))}}),$(".enquete_div_principal"+$scope.data).height($(".enquete_div_principal"+$scope.data+" .results").height()))};$scope.mostrarRespostas=function(){"respostas"!=$scope.selection?($scope.selection="respostas",1==$scope.versao?$(".enquete-"+$scope.data+" .def-result-message").html("").hide():($(".enquete-"+$scope.data+" div .step1").removeClass("fadeIn"),$(".enquete-"+$scope.data+" div .step2").addClass("fadeIn"),setTimeout(function(){$(".enquete-"+$scope.data+" .chart").easyPieChart({easing:"easeOut",barColor:"#0f0f0f",trackColor:"#e7e7e7",scaleColor:"transparent",lineCap:"butt",lineWidth:8,size:118,onStep:function(from,to,percent){$(this.el).find(".percent").text(Math.round(percent))}}),$(".enquete_div_principal"+$scope.data).height($(".enquete_div_principal"+$scope.data+" .results").height())},100))):($scope.selection="voto",1==$scope.versao||($(".enquete-"+$scope.data+" div .step2").removeClass("fadeIn"),$(".enquete-"+$scope.data+" div .step1").addClass("fadeIn")))},$(function(){load_noivos(login,function(){noivo=this,template_enquete.fetch({cache:!1,data:{id_noivo:noivo.get("id_noivo")},success:function(){updateScope(),$scope.computarVoto=function(){(new TemplateEnqueteUsuario).save({id_noivo:noivo.get("id_noivo"),enquete:template_enquete.get("id_enquete"),resposta:$scope.usuario.resposta},{wait:!0,success:function(model){model.get("warning")?$scope.$apply(function(){$scope.usuario.error=!0,$scope.usuario.error_message=model.get("message"),displayErrorMessage(model)}):$scope.$apply(function(){$scope.usuario.error=!1,$scope.usuario.error_message="",$scope.usuario.resposta_enviada=!0,template_enquete.fetch({cache:!1,data:{id_noivo:noivo.get("id_noivo")},success:function(){updateScope(),displayResult()}})})},error:function(model,xhr){var response=xhr.responseText,response_obj=JSON.parse(response);$scope.$apply(function(){$scope.usuario.error=!0,$scope.usuario.error_message=response_obj.message})}})},$(".enquete_div_principal"+$scope.data).height($("#enquete_ul").height())}})})})})}var directive={controller:controller,restrict:"E",scope:{data:"@",versao:"@"},templateUrl:"/components/enquete_directive/component.html"};return controller.$inject=["$scope","$window","$element","$attrs","$sce"],directive}iCaseiApp.directive("enqueteWidget",enqueteWidget),iCaseiApp.directive("enqueteError",[function(){function link(scope,element,attrs){function updateError(value,selection){"respostas"!=selection?(1==attrs.isError?element.addClass("error"):element.addClass("success"),value&&""!=value?element.html(value).show():element.hide()):element.hide()}attrs.$observe("errorMessage",function(value){updateError(value,scope.selection)}),scope.$watch(function(scope){return scope.selection},function(){updateError(attrs.errorMessage,scope.selection)})}return{link:link}}]),iCaseiApp.directive("enqueteEnviarBtn",[function(){function link(scope,element,attrs){function updateBtn(){1==attrs.respostaEnviada?"respostas"==scope.selection?(element.text(I18n.t("poll.buttons.sent_vote")),element.show()):element.hide():"respostas"==scope.selection?element.hide():(element.text(I18n.t("poll.buttons.send_vote")),element.show())}attrs.$observe("respostaEnviada",function(value){updateBtn(value)}),scope.$watch(function(scope){return scope.selection},function(value){updateBtn(value)})}return{link:link}}])}();