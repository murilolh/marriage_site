function jQueryAudioPlayer(element,options){this.options=jQuery.extend({},jQueryAudioPlayer.DEFAULTS,options||{}),this.element=element}jQuery.fn.audioPlayer=function(cfg){return"string"!=typeof cfg&&(cfg=cfg||{},this.each(function(idx,element){getParameterByName("mobile",window.location.href)||getCookie("mobile")?(document.getElementById("music").remove(),document.getElementById("music_playlist").remove()):(element.audioPlayer=new jQueryAudioPlayer(jQuery(element),cfg),element.audioPlayer.init())})),this},jQueryAudioPlayer.instances||(jQueryAudioPlayer.instances={}),window.jQueryAudioPlayer||(window.jQueryAudioPlayer=function(instanceName){return jQueryAudioPlayer.instances[instanceName]}),jQueryAudioPlayer.prototype._loadPlaylist=function(){var self=this;this.options.playlistUrl&&""!=this.options.playlistUrl?$.ajax({url:this.options.playlistUrl,type:"GET",dataType:"json",success:function(ret){ret?(self.playlist=ret,self._playlistLoaded(!0)):self._playlistLoaded(!1)},error:function(){self._playlistLoaded(!1)}}):self.options.playlist&&""!=self.options.playlist?(self.playlist=JSON.parse(this.options.playlist),self._playlistLoaded(!0)):self.options.element&&self.options.element&&(self.playlist=[],$(self.options.element).each(function(){var album=$(this).attr("album"),artist=$(this).attr("artist"),title=$(this).attr("title"),location=$(this).attr("href");self.playlist.push({file:location,artist:artist,album:album,title:title})}),self._playlistLoaded(!0))},jQueryAudioPlayer.prototype._setInfo=function(pos){var str_artist="";this.playlist[pos]&&this.playlist[pos].artist&&""!=this.playlist[pos].artist&&(str_artist+=this.playlist[pos].artist);var str_title="";this.playlist[pos]&&this.playlist[pos].title&&""!=this.playlist[pos].title&&(str_title=this.playlist[pos].title),this.element.find(".artist-str").html("<span></span>"+str_artist),this.element.find(".title-str").html("<span></span>"+str_title),this.element.find(".current-track").html(this.current+1)},jQueryAudioPlayer.prototype.gotoNext=function(){++this.current>=this.playlist.length&&(this.current=0),this.play("next")},jQueryAudioPlayer.prototype.gotoPrevious=function(){--this.current<0&&(this.current=this.playlist.length-1),this.play("prev")},jQueryAudioPlayer.prototype.pause=function(){this._pause(),this.stoped=!1,this.paused=!0,this.playButton.removeClass("pause").addClass("play"),this._dispatchOnPause()},jQueryAudioPlayer.prototype.stop=function(){this._stop(),this.current=0,this.stoped=!0,this.paused=!1,this.playButton.removeClass("pause").addClass("play"),this._setLoadedProgress(0),this._setTimeProgress(0),this._dispatchOnStop()},jQueryAudioPlayer.prototype.play=function(cmd){this.paused&&!cmd||(this._src(this.playlist[this.current].file),this._setLoadedProgress(100),this.element.find(".artist-str").html(this.options.loadingStr),this.element.find(".title-str").html(this.options.loadingStr),this.playing_track=this.current,this.element.find(".current-track").html(this.current+1)),this.paused&&cmd?(this._load(),this._setInfo(this.current)):(this._play(),this.stoped=!1,this.paused=!1,this.playButton.removeClass("play").addClass("pause"),this._dispatchOnPlay()),this.options.pauseaE()},jQueryAudioPlayer.prototype.askToPlay=function(){var self=this;Boxy.ask(this.options.askStr,this.options.askBtns,function(val){val==self.options.askBtns[0]?self.play():((navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/android/i))&&$("#music").hide(),self._setInfo(self.current))},{title:this.options.askTitleStr})},jQueryAudioPlayer.prototype._playlistLoaded=function(loaded){loaded?(this.total=this.playlist.length,this.element.find(".total-tracks").html(this.total),this.current=0,this.paused=!1,this.stoped=!0,this.element.find(".artist-str").html(""),this.element.find(".title-str").html(""),this.options.autoPlay?1==this.options.askToPlay||navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/android/i)?this.askToPlay():this.play():this._setInfo(this.current)):console.error("playlist not loaded")},jQueryAudioPlayer.prototype._checkSupport=function(){if(this.options.onlyMobile&&!(navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/android/i)))return!1;try{if(!this.audioElement||!this.audioElement.canPlayType)return!1;var canPlay;if("maybe"!=(canPlay=this.audioElement.canPlayType("audio/mp3"))&&"probably"!=canPlay&&"maybe"!=(canPlay=this.audioElement.canPlayType("audio/mpeg"))&&"probably"!=canPlay)return!1}catch(e){return!1}return!0},jQueryAudioPlayer.prototype._dispatchOnNotSupport=function(){this.options.onNotSupport&&this.options.onNotSupport.call(this)},jQueryAudioPlayer.prototype._dispatchOnPause=function(){this.options.onPause&&this.options.onPause.call(this)},jQueryAudioPlayer.prototype._dispatchOnStop=function(){this.options.onStop&&this.options.onStop.call(this)},jQueryAudioPlayer.prototype._dispatchOnPlay=function(){this.options.onPlay&&this.options.onPlay.call(this)},jQueryAudioPlayer.prototype._setLoadedProgress=function(loaded){var width=this.controls.find(".seeker").width()*loaded/100;this.controls.find(".loaded").css("width",width+"px")},jQueryAudioPlayer.prototype._setTimeProgress=function(played){var width=this.controls.find(".seeker").width()*played/100;this.controls.find(".progress").css("width",width+"px")},jQueryAudioPlayer.prototype._volumeAdjustment=function(){var volume=100*this._getVolume(),width=this.controls.find(".volume").width()*volume/100;this.controls.find(".volume-progress").css("width",width+"px")},jQueryAudioPlayer.prototype._getParameters=function(){return{movieName:this.movieName,volume:this.options.volume}},jQueryAudioPlayer.prototype._getFlashObject=function(){var flashObject=null;if("function"==typeof document[this.movieName].playSound?flashObject=document[this.movieName]:"function"==typeof window[this.movieName].playSound&&(flashObject=window[this.movieName]),!flashObject)throw"Invalid flash object";return flashObject},jQueryAudioPlayer.prototype._setVolume=function(vol){if(this.audioElement)this.audioElement.volume=vol;else{var flashObject=this._getFlashObject();if(flashObject)try{flashObject.setVolume(vol)}catch(e){}}this._volumeAdjustment()},jQueryAudioPlayer.prototype._getVolume=function(){if(this.audioElement)return this.audioElement.volume;var flashObject=this._getFlashObject();if(flashObject)try{return flashObject.getVolume()}catch(e){}return 0},jQueryAudioPlayer.prototype._play=function(){if(this.audioElement)this.audioElement.play();else{var flashObject=this._getFlashObject();if(flashObject)try{flashObject.playSound()}catch(e){}}},jQueryAudioPlayer.prototype._pause=function(){if(this.audioElement)this.audioElement.pause();else{var flashObject=this._getFlashObject();if(flashObject)try{flashObject.pauseSound()}catch(e){}}},jQueryAudioPlayer.prototype._stop=function(){if(this.audioElement)this.audioElement.src=this.playlist[this.current].file,this.audioElement.pause();else{var flashObject=this._getFlashObject();if(flashObject){flashObject.setSrc(this.playlist[this.current].file);try{flashObject.stopSound()}catch(e){}}}},jQueryAudioPlayer.prototype._load=function(){if(this.audioElement)this.audioElement.load();else{var flashObject=this._getFlashObject();if(flashObject)try{flashObject.loadSound()}catch(e){}}},jQueryAudioPlayer.prototype._src=function(url){if(this.audioElement)this.audioElement.src=url;else{var flashObject=this._getFlashObject();if(flashObject)try{flashObject.setSrc(url)}catch(e){}}},jQueryAudioPlayer.prototype.initFlashFallback=function(){this.audioElement=null,this.movieName="jQueryAudioPlayer"+this.element.attr("id");var container=$('<div><div class="flash"></div></div>');container.find(".flash").attr("id",this.movieName),container.css("width","1px"),container.css("height","1px"),container.css("overflow","hidden"),container.css("position","absolute"),this.element.prepend(container),jQueryAudioPlayer.instances[this.movieName]=this;var flash_file=this.options.basePath+"/audioplayer.swf?random="+Math.random()+"&timestamp="+(new Date).getDate();swfobject.embedSWF(flash_file,this.movieName,1,1,"9.0.0",this.options.flashCodeBase,this._getParameters(),{wmode:this.options.windowMode,allowScriptAccess:"always"})},jQueryAudioPlayer.prototype.init=function(){try{this.audioElement=document.createElement("audio")}catch(e){this.audioElement=null}if(!this._checkSupport()){if(!this.options.useFlashFallback)return void this._dispatchOnNotSupport();this.initFlashFallback()}this.controls=$(jQueryAudioPlayer.templates[this.options.template]),this.controls.addClass(this.options.cssTemplate),this.element.append(this.controls);var self=this;this.playButton=this.controls.find(".play"),this.audioElement&&(this.audioElement.preload="auto",this.audioElement.addEventListener("ended",function(){self.gotoNext()},!0),this.audioElement.addEventListener("playing",function(){self._setInfo(self.current)},!0),this.audioElement.addEventListener("waiting",function(){self.element.find(".artist-str").html(self.options.loadingStr),self.element.find(".title-str").html(self.options.loadingStr)},!0),this.audioElement.addEventListener("progress",function(){var loaded=0;self.audioElement.duration&&self.audioElement.duration>0&&self.audioElement.buffered.length>0&&(loaded=parseInt(self.audioElement.buffered.end(0)/self.audioElement.duration*100,10)),self._setLoadedProgress(loaded)},!0),this.audioElement.addEventListener("timeupdate",function(){var loaded=parseInt(self.audioElement.currentTime/self.audioElement.duration*100,10);self._setTimeProgress(loaded)},!0),this.audioElement.addEventListener("volumechange",function(){self._volumeAdjustment()},!0),this.audioElement.addEventListener("load",function(e){e.target},!0),this.audioElement.addEventListener("error",function(e){e.target},!0),this.audioElement.addEventListener("loadedmetadata",function(e){var t=e.target;if("error"==e.type){e.target.error.code;console.error("error: "+t.currentSrc+", "+e.target.error.code)}},!0)),this.controls.find(".volume-area").on("touchstart",function(ev){var touchX=(ev=ev.originalEvent).touches[0].screenX,posX=$(this).offset().left,volume=($(this).offset().top,100*(touchX-posX)/self.controls.find(".volume").width());return volume>100&&(volume=100),volume<0&&(volume=0),self._setVolume(volume/100),ev.stopPropagation(),ev.preventDefault(),!1}),this.controls.find(".volume-area").on("touchmove",function(ev){var touchX=(ev=ev.originalEvent).touches[0].screenX,posX=$(this).offset().left,volume=($(this).offset().top,100*(touchX-posX)/self.controls.find(".volume").width());return volume>100&&(volume=100),volume<0&&(volume=0),self._setVolume(volume/100),ev.stopPropagation(),ev.preventDefault(),!1}),this.controls.find(".volume").click(function(ev){var posX=$(this).offset().left,posY=$(this).offset().top,x=ev.pageX-posX,volume=(ev.pageY,100*x/self.controls.find(".volume").width());volume>100&&(volume=100),volume<0&&(volume=0),self._setVolume(volume/100)}),this.controls.find(".play").click(function(){self.paused||self.stoped?self.play():self.pause()}),this.controls.find(".stop").click(function(){self.stop()}),this.controls.find(".previous").click(function(){self.gotoPrevious()}),this.controls.find(".next").click(function(){self.gotoNext()}),this.audioElement&&(this._setVolume(this.options.volume/100),this._loadPlaylist())},jQueryAudioPlayer.templates={"default":'<div id="main_player"><a href="javascript: void(0);" class="button back"></a><a href="javascript: void(0);" class="button play"></a><a href="javascript: void(0);" class="button stop"></a><a href="javascript: void(0);" class="button next"></a><span class="info"></span></div>',mini:'<div id="main_player"><a href="javascript: void(0);" class="button play"></a><a href="javascript: void(0);" class="button stop"></a><a href="javascript: void(0);" class="button back"></a><a href="javascript: void(0);" class="button next"></a><div class="seeker"><div class="loaded"><div class="progress"></div></div></div></div>',"new":'<div id="main_player"> \t\t\t\t<div class="line-up"> \t\t\t    \t<div class="music-info"> \t\t\t    \t\t<div class="title"> \t\t\t    \t\t\t<span class="title-icon">&nbsp;</span> \t\t\t    \t\t\t<span class="title-str"></span> \t\t\t    \t\t</div> \t\t\t    \t\t<div class="artist"> \t\t\t    \t\t\t<span class="artist-icon">&nbsp;</span> \t\t\t    \t\t\t<span class="artist-str"></span> \t\t\t    \t\t</div> \t\t\t    \t</div> \t\t\t\t    <div class="tracks"> \t\t\t\t    \t<span class="current-track">0</span> \t\t\t\t    \t&nbsp;/&nbsp; \t\t\t\t    \t<span class="total-tracks">0</span> \t\t\t\t    </div> \t\t\t\t    <div class="controls"> \t\t\t\t    \t<div class="previous-area"> \t\t\t\t    \t\t<a class="previous" href="javascript: void(0);"></a> \t\t\t\t    \t</div> \t\t\t\t    \t<div class="play-area"> \t\t\t\t    \t\t<a class="play" href="javascript: void(0);"></a> \t\t\t\t    \t</div> \t\t\t\t    \t<div class="next-area"> \t\t\t\t    \t\t<a class="next" href="javascript: void(0);"></a> \t\t\t\t    \t</div> \t\t\t\t    </div> \t\t\t\t</div> \t\t\t    <div class="line-bottom"> \t\t\t    \t<div class="seeker-area"> \t\t\t    \t\t<div class="seeker"> \t\t\t    \t\t\t<div class="loaded"> \t\t\t    \t\t\t\t<div class="progress"></div> \t\t\t    \t\t\t</div> \t\t\t    \t\t</div> \t\t\t    \t</div> \t\t\t    \t<div class="volume-area"> \t\t\t    \t\t<span class="volume-icon">&nbsp;</span> \t\t\t    \t\t<div class="volume"> \t\t\t    \t\t\t<div class="volume-progress"></div> \t\t\t    \t\t</div> \t\t\t    \t</div> \t\t\t    </div> \t\t\t </div>',player_custom:'<div id="main_player" class="main"> \t\t\t\t        <div class="info music-info"> \t\t\t\t            <p class="song title-str"><span></span></p> \t\t\t\t            <p class="artist artist-str"><span></span></p> \t\t\t\t        </div> \t\t\t\t        <div class="tracks"> \t\t\t\t        \t<span class="current-track">0</span>/<span class="total-tracks">0</span> \t\t\t\t        </div> \t\t\t\t        <div class="control controls"> \t\t\t\t            <div class="nav prev previous"></div> \t\t\t\t            <div class="play-area"><div class="play play-pause"></div></div> \t\t\t\t            <div class="nav next"></div> \t\t\t\t        </div> \t\t\t\t        <div class="seeker-area"> \t\t\t\t        \t<div class="seeker"> \t\t\t\t        \t <div class="bg-track"></div> \t\t\t\t\t\t        <div class="progress track "> \t\t\t\t\t\t            <div class="bar"> \t\t\t\t\t\t              <div class="drag"></div> \t\t\t\t\t\t            </div> \t\t\t\t\t\t        </div><!-- end .progress --> \t\t\t\t\t\t    </div> \t\t\t\t\t\t</div> \t\t\t\t        <div class="volume-icon"></div> \t\t\t\t        <div class="volume track"> \t\t\t\t            <div class="bar volume-progress"> \t\t\t\t              <div class="drag"></div> \t\t\t\t            </div> \t\t\t\t        </div><!-- end .valume --> \t\t\t\t        <div class="div-aux div-aux-1"></div> \t\t\t\t        <div class="div-aux div-aux-2"></div> \t\t\t\t        <div class="div-aux div-aux-3"></div><!-- divs auxiliares para elementos do skin --> \t\t\t\t    </div> ',mobile:'<ul class="playerMobile"> \t\t\t\t\t<li> \t\t\t\t    \t<a href="#" class="prev previous"></a> \t\t\t\t    </li> \t\t\t\t    <li > \t\t\t\t    \t<a href="#" class="playpause play play-pause"></a> \t\t\t\t    </li> \t\t\t\t    <li> \t\t\t\t    \t<a href="#" class="next"></a> \t\t\t\t    </li> \t\t\t\t</ul> '},jQuery.extend(jQueryAudioPlayer,{DEFAULTS:{template:"default",cssTemplate:"default",autoPlay:!0,askToPlay:!1,volume:100,playlistUrl:"",playlist:"",element:"",onlyMobile:!1,onNotSupport:null,pauseaE:null,onPause:null,onPlay:null,onStop:null,useFlashFallback:!0,flashClassId:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",flashCodeBase:"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab",basePath:"",windowMode:"transparent",loadingStr:"Carregando...",askTitleStr:"Ativar m\xfasica?",askStr:"Essa p\xe1gina possui um playlist musical. Deseja reproduzir enquanto navega?",askBtns:["Sim","N\xe3o"]}}),jQueryAudioPlayer.prototype.onInitPlugin=function(){this._setVolume(this.options.volume/100),this._loadPlaylist()},jQueryAudioPlayer.prototype.onProgress=function(val){this._setLoadedProgress(val)},jQueryAudioPlayer.prototype.onTimer=function(total,current){if(0!=total){var loaded=parseInt(current/total*100);this._setTimeProgress(loaded)}},jQueryAudioPlayer.prototype.onEnded=function(){this.gotoNext()},jQueryAudioPlayer.prototype.onPlaying=function(){this._setInfo(this.current)};