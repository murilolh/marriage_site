var HomeView=null;!function($){HomeView=BaseBackboneView.extend({events:{"click #votar":"votar"},mostrar:function(template_enquete_usuario){var self=this;self.options.enquete.fetch({data:{id_enquete:self.options.enquete.get("id_enquete"),id_noivo:self.options.noivos.get("id_noivo")},success:function(){render_template("template_enquete_resposta_id","/templates/backbone/"+self.options.noivos.get("id_noivo")+"/home/"+self.options.noivos.get("template_html_version")+"/respostas",{noivos:self.options.noivos.attributes,images:self.options.imagens.toJSON(),home:self.options.home.attributes,enquete:self.options.enquete.attributes,respostas:template_enquete_usuario},function(item){change_content(item,function(){},{noivos:self.options.noivos,container:"#enquete",no_scroll:!0,destroy_view:!1})})},error:function(){Boxy.alert(I18n.t("poll.errors.error"),function(){},{title:"ERRO",closeText:"[Fechar]"})}})},votar:function(){var self=this;if("true"==$("meta[name='CD']").attr("content"))$(".def-result-message").addClass("error").removeClass("success").html(I18n.t("poll.errors.offline")).show(),self.mostrar({ret:1});else{var resposta=$("input[name='poll']:checked").val();if(!resposta||""==resposta)return void $(".def-result-message").addClass("error").removeClass("success").html(I18n.t("poll.errors.answer")).show();var template_enquete_usuario=new TemplateEnqueteUsuario;window.loading.jLoading("block",!0),template_enquete_usuario.save({id_noivo:self.options.noivos.get("id_noivo"),enquete:self.options.enquete.get("id_enquete"),resposta:resposta},{wait:!0,success:function(model){window.loading.jLoading("block",!1),model.get("warning")?$(".def-result-message").addClass("error").removeClass("success").html(model.get("message")).show():$(".def-result-message").html("").hide(),self.mostrar(template_enquete_usuario)},error:function(model,xhr){window.loading.jLoading("block",!1);var response=xhr.responseText,response_obj=JSON.parse(response);$(".def-result-message").addClass("error").removeClass("success").html(response_obj.message).show()}})}},initialize:function(){this.constructor.__super__.initialize.call(this);var self=this;this.adopted=!0;var item=$(".template-home");item.get(0)?(this.setElement(item),this.options.onload&&this.options.onload.call(self)):(this.adopted=!1,render_template("template_home_id","/templates/backbone/"+this.options.noivos.get("id_noivo")+"/home/"+this.options.noivos.get("template_html_version")+"/index",{noivos:this.options.noivos.attributes,images:this.options.imagens.toJSON(),home:this.options.home.attributes,enquete:this.options.enquete.attributes,pagina:self.options.pagina.attributes},function(ret){self.setElement(ret),self.options.onload&&self.options.onload.call(self)}))},before_remove:function(){this.options.noivos.get("slider")&&1!=this.options.noivos.get("slider")||$("#peKenBurns").kenburn({})},render:function(){var self=this,slider=get_meta("slider");return load_css("//assets1.icasei.com.br/assets/"+slider+".css"),load_js("//assets1.icasei.com.br/assets/"+slider+".js",function(){var config=self.options.imagens.get("config");if(self.options.noivos.get("slider")&&1!=self.options.noivos.get("slider")){var path="/assets/sliders/layerslider/skins/";"true"==get_meta("CD")&&(path="assets/sliders/layerslider/skins/"),$("#layerslider").layerSlider({width:"500px",height:"320px",responsive:!0,responsiveUnder:0,sublayerContainer:0,autoStart:!0,pauseOnHover:1==config.pause,firstLayer:1,animateFirstLayer:!0,randomSlideshow:1==config.random,twoWaySlideshow:!0,loops:0,forceLoopNum:!0,autoPlayVideos:!0,autoPauseSlideshow:"auto",youtubePreview:"maxresdefault.jpg",keybNav:!0,touchNav:!0,skin:config.theme,skinsPath:path,globalBGColor:"transparent",navPrevNext:!0,navStartStop:!0,navButtons:"none"!=config.thumb,hoverPrevNext:!0,hoverBottomNav:!0,showBarTimer:!1,showCircleTimer:!0,thumbnailNavigation:config.thumb,tnWidth:100,tnHeight:60,tnContainerWidth:"60%",tnActiveOpacity:35,tnInactiveOpacity:100,imgPreload:!0,yourLogo:!1,yourLogoStyle:"left: 10px; top: 10px;",yourLogoLink:!1,yourLogoTarget:"_self",cbInit:function(){"true"!=$("meta[name='CD']").attr("content")&&$("#layerslider").find('*[class*="ls-bg"]').each(function(){var _src=$(this).attr("src").split("/"),_new_src="",_width=this.width,_width_min=540,_height_min=320,_landscape=!0;if(this.height>_width&&(_landscape=!1),_landscape)for(var i=1;i<_src.length;i++)6==i&&_width>_width_min&&(_src[i]=_width_min),7==i&&_width>_width_min&&(_src[i]=0),_new_src+="/"+_src[i];else for(i=1;i<_src.length;i++)6==i&&(_src[i]=0),7==i&&(_src[i]=_height_min),_new_src+="/"+_src[i];$(this).attr("src",_new_src)})},cbStart:function(){},cbStop:function(){},cbPause:function(){},cbAnimStart:function(){$(".ls-curtiles").fadeOut("slow")},cbAnimStop:function(){$(".ls-curtiles").fadeOut("slow")},cbPrev:function(){$(".ls-curtiles").fadeOut("slow")},cbNext:function(){$(".ls-curtiles").fadeOut("slow")}})}else $("#peKenBurns").kenburn({width:540,height:320,thumbWidth:80,thumbHeight:50,thumbAmount:6,thumbSpaces:1,thumbPadding:9,thumbStyle:config.thumb,bulletXOffset:0,bulletYOffset:"bullet"==config.thumb?-10:-369,shadow:1==config.shadow?"on":"off",repairChromeBug:"on",timerShow:"on",touchenabled:"on",pauseOnRollOverThumbs:"off",pauseOnRollOverMain:1==config.pause?"on":"off",preloadedSlides:6,timer:10,debug:"off"})}),this}})}(jQuery);