var StoreController=null;jQuery,StoreController=Backbone.Router.extend({routes:{":login/store/index/:id/:id_loja.html":"realodStoreLogin",":login/store/index/:id/:id_loja/:page.html":"realodStoreLoginPage",":login/store/:id/:id_loja.html":"realodStoreLogin",":login/store/:id/:id_loja/:page.html":"loadLoginStorePage",":login/store/:id/:id_loja":"realodStoreLogin",":login/store/:id/:id_loja/:page":"loadLoginStorePage",":login/store/:id/:id_loja/:page/cart":"loadLoginStorePageCart",":login/store/:id/:id_loja/:page/cart_info":"loadLoginStorePageCartInfo",":login/store/:id/:id_loja/:page/payment":"loadLoginStorePagePayment",":login/store/:id/:id_loja/:page/confirm":"loadLoginStorePageConfirm",":login/:lang/store/index/:id/:id_loja.html?mobile=:mobile":"realodStoreLoginLang",":login/:lang/store/index/:id/:id_loja/:page.html?mobile=:mobile":"realodStoreLoginLangPage",":login/:lang/store/:id/:id_loja.html?mobile=:mobile":"realodStoreLoginLang",":login/:lang/store/:id/:id_loja/:page.html":"loadLoginLangStorePage",":login/:lang/store/:id/:id_loja?mobile=:mobile":"realodStoreLoginLang",":login/:lang/store/:id/:id_loja/:page":"loadLoginLangStorePage",":login/:lang/store/:id/:id_loja/:page/cart":"loadLoginLangStorePageCart",":login/:lang/store/:id/:id_loja/:page/cart_info":"loadLoginLangStorePageCartInfo",":login/:lang/store/:id/:id_loja/:page/payment":"loadLoginLangStorePagePayment",":login/:lang/store/:id/:id_loja/:page/confirm":"loadLoginLangStorePageConfirm",":lang/store/index/:id/:id_loja.html":"realodStoreLang",":lang/store/index/:id/:id_loja/:page.html":"realodStoreLangPage",":lang/store/:id/:id_loja.html":"realodStoreLang",":lang/store/:id/:id_loja/:page.html":"loadLangStorePage",":lang/store/:id/:id_loja":"realodStoreLang",":lang/store/:id/:id_loja/:page":"loadLangStorePage",":lang/store/:id/:id_loja/:page/cart":"loadLangStorePageCart",":lang/store/:id/:id_loja/:page/cart_info":"loadLangStorePageCartInfo",":lang/store/:id/:id_loja/:page/payment":"loadLangStorePagePayment",":lang/store/:id/:id_loja/:page/confirm":"loadLangStorePageConfirm"},realodStoreLogin:function(login,id,id_loja){this.realodStore(login,null,id,id_loja,null)},realodStoreLoginPage:function(login,id,id_loja,page){this.realodStore(login,null,id,id_loja,page)},realodStoreLoginLang:function(login,lang,id,id_loja,mobile){"true"==mobile&&this.createCookie("mobile","true",7),this.realodStore(login,lang,id,id_loja,null)},realodStoreLoginLangPage:function(login,lang,id,id_loja,page,mobile){"true"==mobile&&this.createCookie("mobile","true",7),this.realodStore(login,lang,id,id_loja,page)},realodStoreLang:function(lang,id,id_loja){this.realodStore(null,lang,id,id_loja,null)},realodStoreLangPage:function(lang,id,id_loja,page){this.realodStore(null,lang,id,id_loja,page)},realodStore:function(login,lang,id,id_loja,page){url="/",url+=null!==login&&login!==undefined?login+"/":"",url+=null!==lang&&lang!==undefined?lang+"/":"",url+="store/"+id+"/"+id_loja,url+="/"+(null!==page&&page!==undefined?page:"1"),Backbone.history.navigate(url,!0)},createCookie:function(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"},loadLoginStore:function(login,id,id_loja){this.loadStore(login,null,id,id_loja,null)},loadLoginStorePage:function(login,id,id_loja,page){this.loadStore(login,null,id,id_loja,page)},loadLoginStorePageCart:function(login,id,id_loja,page){this.loadStoreCart(login,null,id,id_loja,page)},loadLoginStorePageCartInfo:function(login,id,id_loja,page){this.loadStoreCartInfo(login,null,id,id_loja,page)},loadLoginStorePagePayment:function(login,id,id_loja,page){this.loadStorePayment(login,null,id,id_loja,page)},loadLoginStorePageConfirm:function(login,id,id_loja,page){this.loadStoreConfirm(login,null,id,id_loja,page)},loadLoginLangStore:function(login,lang,id,id_loja){this.loadStore(login,lang,id,id_loja,null)},loadLoginLangStorePage:function(login,lang,id,id_loja,page){this.loadStore(login,lang,id,id_loja,page)},loadLoginLangStorePageCart:function(login,lang,id,id_loja,page){this.loadStoreCart(login,lang,id,id_loja,page)},loadLoginLangStorePageCartInfo:function(login,lang,id,id_loja,page){this.loadStoreCartInfo(login,lang,id,id_loja,page)},loadLoginLangStorePagePayment:function(login,lang,id,id_loja,page){this.loadStorePayment(login,lang,id,id_loja,page)},loadLoginLangStorePageConfirm:function(login,lang,id,id_loja,page){this.loadStoreConfirm(login,lang,id,id_loja,page)},loadLangStore:function(lang,id,id_loja){this.loadStore(null,lang,id,id_loja,null)},loadLangStorePage:function(lang,id,id_loja,page){this.loadStore(null,lang,id,id_loja,page)},loadLangStorePageCart:function(lang,id,id_loja,page){this.loadStoreCart(null,lang,id,id_loja,page)},loadLangStorePageCartInfo:function(lang,id,id_loja,page){this.loadStoreCartInfo(null,lang,id,id_loja,page)},loadLangStorePagePayment:function(lang,id,id_loja,page){this.loadStorePayment(null,lang,id,id_loja,page)},loadLangStorePageConfirm:function(lang,id,id_loja,page){this.loadStoreConfirm(null,lang,id,id_loja,page)},init_loja:function(noivos,id,id_loja,page,callback){var self=this;if(id=parseInt(id),id_loja=parseInt(id_loja),page=parseInt(page),this.info)self.info.page=page,id&&self.info.id_loja!=id&&(self.info.id_loja=id),id_loja?self.info.id_loja_sel!=id_loja&&(self.info.id_loja_sel=id_loja):id_loja=self.info.id_loja_sel,callback&&callback.call(self,id,id_loja,page);else if(this.info={order:null,id_loja_categoria:-2,id_loja:id,id_loja_sel:id_loja,page:page,guid:Math.floor(1e8*Math.random()+1)},id)id&&self.info.id_loja!=id&&(self.info.id_loja=id),callback&&callback.call(self,id,id_loja,page);else{var cart=new Cart;cart.fetch({data:{id_noivo:noivos.get("id_noivo"),id_loja:id,page:page},success:function(){(id=parseInt(cart.get("id_loja")))||(id=9),self.info.id_loja=id,callback&&callback.call(self,id,id_loja,page)},error:function(){id=9,self.info.id_loja=id,callback&&callback.call(self,id,id_loja,page)}})}},loadStoreConfirm:function(login,lang,id,id_loja,page){var self=this;load_noivos(login,function(success){if(success){var noivos=this;self.init_loja(noivos,id,id_loja,page,function(){cart=new Cart,cart.fetch({data:{id_noivo:noivos.get("id_noivo"),use_last:!0},success:function(){var template_loja_dado=new TemplateLojaDado;template_loja_dado.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){backboneObjects.confirm_view=new ConfirmView({noivos:noivos,cart:cart,info:self.info,loja_dado:template_loja_dado,onload:function(){var self=this;if(!1===this.adopted){var element=this.$el;change_content(element,function(){App.current_view=self,self.render()},{template:"store",noivos:noivos})}else App.current_view=self,this.render()}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})})}})},loadStorePayment:function(login,lang,id,id_loja,page){var self=this;load_noivos(login,function(success){if(success){var noivos=this;self.init_loja(noivos,id,id_loja,page,function(id,id_loja,page){cart=new Cart,cart.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){if(cart.get("products").length<=0)Backbone.history.navigate("/"+noivos.get("login")+"/store/"+id+"/"+id_loja+"/"+page,!0);else{var template_loja_dado=new TemplateLojaDado;template_loja_dado.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){var tipos_pagamentos=new CotaTiposPagamentosNoivo;tipos_pagamentos.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){backboneObjects.payment_view=new PaymentView({noivos:noivos,cart:cart,info:self.info,loja_dado:template_loja_dado,tipos_pagamentos:tipos_pagamentos,onload:function(){var self=this;if(!1===this.adopted){var element=this.$el;change_content(element,function(){App.current_view=self,self.render()},{template:"store",noivos:noivos})}else App.current_view=self,this.render()}})},error:function(e,xhr){backbone_proccess_error(xhr)}})},error:function(e,xhr){backbone_proccess_error(xhr)}})}},error:function(e,xhr){backbone_proccess_error(xhr)}})})}})},loadStoreCartInfo:function(login,lang,id,id_loja,page){var self=this;load_noivos(login,function(success){if(success){var noivos=this;self.init_loja(noivos,id,id_loja,page,function(){var template_loja_dado=new TemplateLojaDado;template_loja_dado.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){var cart=new Cart;cart.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){backboneObjects.cart_info_view=new CartInfoView({noivos:noivos,cart:cart,info:self.info,loja_dados:template_loja_dado,onload:function(){var self=this;if(!1===this.adopted){var element=this.$el;change_content(element,function(){App.current_view=self,self.render()},{template:"store",noivos:noivos})}else App.current_view=self,this.render()}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})})}})},loadStoreCart:function(login,lang,id,id_loja,page){var self=this;load_noivos(login,function(success){if(success){var noivos=this;self.init_loja(noivos,id,id_loja,page,function(){var template_loja_dado=new TemplateLojaDado;template_loja_dado.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){var cart=new Cart;cart.fetch({data:{id_noivo:noivos.get("id_noivo")},success:function(){backboneObjects.cart_view=new CartView({noivos:noivos,cart:cart,info:self.info,loja_dados:template_loja_dado,onload:function(){var self=this;if(!1===this.adopted){var element=this.$el;change_content(element,function(){App.current_view=self,self.render()},{template:"store",noivos:noivos})}else App.current_view=self,this.render()}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})})}})},loadStore:function(login,lang,id,id_loja,page){var self=this;load_noivos(login,function(success){if(success){var noivos=this;self.init_loja(noivos,id,id_loja,page,function(id,id_loja,page){var menu_noivo=new MenuNoivo;menu_noivo.fetch({cache:!1,data:{id_noivo:noivos.get("id_noivo"),id_recurso:id,id_loja:id_loja},success:function(){var template_loja_dado=new TemplateLojaDado;template_loja_dado.fetch({cache:!1,data:{id_noivo:noivos.get("id_noivo")},success:function(){0===template_loja_dado.get("mostraordenacao")&&(self.info.id_loja_categoria=-1),null===self.info.order&&(0===template_loja_dado.get("ordenacao")?self.info.order=5:self.info.order=6);var template_produto=new TemplateProduto;template_produto.fetch({cache:!1,data:{id_noivo:noivos.get("id_noivo"),id:menu_noivo.get("recurso").id_tipo_loja,id_loja_categoria:self.info.id_loja_categoria,order:self.info.order,id_loja:id_loja,id_recurso:menu_noivo.get("recurso").id_recurso,page:page},success:function(){var loja_categorias=new LojaCategorias;loja_categorias.fetch({data:{id_noivo:noivos.get("id_noivo"),id_loja:id_loja},success:function(){cart=new Cart,cart.fetch({cache:!1,data:{id_noivo:noivos.get("id_noivo"),id_loja:id},success:function(){backboneObjects.store_view=new StoreView({noivos:noivos,pagina:menu_noivo,entries:template_produto,loja_dados:template_loja_dado,categorias:loja_categorias,info:self.info,cart:cart,onload:function(){var self=this;if(!1===this.adopted){var element=this.$el;change_content(element,function(){App.current_view=self,self.render()},{template:"store",noivos:noivos})}else App.current_view=self,this.render()}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es. (cart)",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es (categorias).",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es. (produtos)",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar informa\xe7\xf5es. (loja_dados)",function(){},{title:"ERRO",closeText:"[Fechar]"})}})},error:function(){Boxy.alert("Erro ao carregar noivos.",function(){},{title:"ERRO",closeText:"[Fechar]"})}})})}else Boxy.alert("Erro ao carregar noivos.",function(){},{title:"ERRO",closeText:"[Fechar]"})})}}),backboneObjects.store_controller=new StoreController;